## -*- mode: python; coding: utf-8 -*-

include("rrul2.conf")
DESCRIPTION="VoIP one-way stream test with competing RRUL test"
DEFAULTS={'PLOT': 'totals_loss'}
TOTAL_LENGTH=LENGTH+2*DELAY

VOIP_HOST=HOST
VOIP_LOCAL_BIND=LOCAL_BIND[0] if LOCAL_BIND else None
VOIP_CONTROL_HOST=CONTROL_HOST or HOST
VOIP_LENGTH=TOTAL_LENGTH
VOIP_CUTOFF=(DELAY,DELAY)
VOIP_MARKING=get_test_parameter("voip_marking", default=None)
include("voip.inc")

PLOTS['ping_delay'] = {'description': 'RRUL Ping and VoIP delay',
                       'type': 'timeseries',
                       'axis_labels': ['Latency (ms)'],
                       'series': [{'data': 'Ping (ms) avg',
                                   'label': 'Average ping RTT',
                                   'color': 'blue'},
                                   {'data': 'VoIP::rtt',
                                   'label': 'VoIP RTT',
                                   'color': 'purple'},
                                  {'data': 'VoIP::jitter',
                                   'label': 'VoIP jitter',
                                   'color': 'green'},]}
PLOTS['totals_loss'] = {'description': 'Total TCP bandwidth with ping, delay, jitter and loss',
                        'type': 'meta',
                        'subplots': ('totals', 'ping_delay', 'voip_loss')}
PLOTS['box_combine'] = {'description': "Box combination plot",
                        'type': 'box_combine',
                        'cutoff': (DELAY,DELAY),
                        'dual_axes': False,
                        'axis_labels': ['Mean goodput (Mbps)'],
                        'series': [{'data': 'TCP download sum',
                                    'label': 'Total TCP download',
                                    'combine_mode': 'meta:MEAN_VALUE'},
                                   {'data': 'TCP upload sum',
                                    'label': 'Total TCP upload',
                                    'combine_mode': 'meta:MEAN_VALUE'}]}
PLOTS['box_voip'] = {'description': "Box combination plot VoIP lantency",
                        'type': 'box',
                        'cutoff': (DELAY,DELAY),
                        'dual_axes': False,
                        'axis_labels': ['Latency (ms)'],
                        'series': [{'data': 'VoIP::rtt',
                                    'label': 'VoIP RTT',
                                    'combine_mode': 'meta:MEAN_VALUE'},
                                   {'data': 'VoIP::jitter',
                                    'label': 'VoIP jitter',
                                    'combine_mode': 'meta:MEAN_VALUE'}]}

include("common.inc")
