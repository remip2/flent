## -*- mode: python; coding: utf-8 -*-

DESCRIPTION="HTTP download/upload with 2 clients"
DEFAULTS={'PLOT': 'bandwidth'}
TOTAL_LENGTH=LENGTH+2*DELAY
HTTP_SIZE=TEST_PARAMETERS.get("http_size", "1M")
HTTP_PORT=TEST_PARAMETERS.get("http_port", 80)
REMOTE_HOST=TEST_PARAMETERS.get("remote_host", None)

DATA_SETS=o()

DATA_SETS['HTTP_GET1'] = {'protocol': 'http', 'direction': 'download', 'port': HTTP_PORT,
                          'length': LENGTH, 'host': HOST, 'size': HTTP_SIZE,
                          'units': 'Mbits/s', 'runner': 'http_perf', 'id': 'HTTP'}
DATA_SETS['HTTP_GET1::upload'] = {'units': 'Mbits/s', 'runner': 'null'}
DATA_SETS['HTTP_GET1::download'] = {'units': 'Mbits/s', 'runner': 'null'}
DATA_SETS['HTTP_GET1::transaction'] = {'units': 'transaction/s', 'runner': 'null'}
DATA_SETS['HTTP_GET1::responsetime'] = {'units': 'ms', 'runner': 'null'}

DATA_SETS['HTTP_GET2'] = {'protocol': 'http', 'direction': 'download', 'port': HTTP_PORT,
                          'length': LENGTH, 'host': HOST, 'size': HTTP_SIZE,
                          'units': 'Mbits/s', 'runner': 'http_perf', 'id': 'HTTP'}
DATA_SETS['HTTP_GET2::upload'] = {'units': 'Mbits/s', 'runner': 'null'}
DATA_SETS['HTTP_GET2::download'] = {'units': 'Mbits/s', 'runner': 'null'}
DATA_SETS['HTTP_GET2::transaction'] = {'units': 'transaction/s', 'runner': 'null'}
DATA_SETS['HTTP_GET2::responsetime'] = {'units': 'ms', 'runner': 'null'}

DATA_SETS['HTTP_POST1'] = {'protocol': 'http', 'direction': 'upload', 'port': HTTP_PORT, 'length': LENGTH, 'host': HOST, 'size': HTTP_SIZE,
                           'units': 'Mbits/s', 'runner': 'http_perf', 'id': 'HTTP'}
DATA_SETS['HTTP_POST1::upload'] = {'units': 'Mbits/s', 'runner': 'null'}
DATA_SETS['HTTP_POST1::download'] = {'units': 'Mbits/s', 'runner': 'null'}
DATA_SETS['HTTP_POST1::transaction'] = {'units': 'transaction/s', 'runner': 'null'}
DATA_SETS['HTTP_POST1::responsetime'] = {'units': 'ms', 'runner': 'null'}

DATA_SETS['HTTP_POST2'] = {'protocol': 'http', 'direction': 'upload', 'port': HTTP_PORT, 'length': LENGTH, 'host': HOST, 'size': HTTP_SIZE,
                           'units': 'Mbits/s', 'runner': 'http_perf', 'id': 'HTTP'}
DATA_SETS['HTTP_POST2::upload'] = {'units': 'Mbits/s', 'runner': 'null'}
DATA_SETS['HTTP_POST2::download'] = {'units': 'Mbits/s', 'runner': 'null'}
DATA_SETS['HTTP_POST2::transaction'] = {'units': 'transaction/s', 'runner': 'null'}
DATA_SETS['HTTP_POST2::responsetime'] = {'units': 'ms', 'runner': 'null'}

DATA_SETS['TCP upload sum'] = {'apply_to': ["HTTP_GET1::upload", "HTTP_GET2::upload", "HTTP_POST1::upload", "HTTP_POST2::upload"],
                               'units': 'Mbits/s',
                               'runner': 'sum',}
DATA_SETS['TCP download sum'] = {'apply_to': ["HTTP_GET1::download", "HTTP_GET2::download", "HTTP_POST1::download", "HTTP_POST2::download"],
                               'units': 'Mbits/s',
                               'runner': 'sum',}

DATA_SETS['TCP upload sum client1'] = {'apply_to': ["HTTP_GET1::upload", "HTTP_POST1::upload"],
                               'units': 'Mbits/s',
                               'runner': 'sum',}
DATA_SETS['TCP download sum client1'] = {'apply_to': ["HTTP_GET1::download", "HTTP_POST1::download"],
                               'units': 'Mbits/s',
                               'runner': 'sum',}

DATA_SETS['TCP upload sum client2'] = {'apply_to': ["HTTP_GET2::upload", "HTTP_POST2::upload"],
                               'units': 'Mbits/s',
                               'runner': 'sum',}
DATA_SETS['TCP download sum client2'] = {'apply_to': ["HTTP_GET2::download", "HTTP_POST2::download"],
                               'units': 'Mbits/s',
                               'runner': 'sum',}


PLOTS['bandwidth'] = {'description': 'TCP bandwidth plot',
      'type': 'timeseries',
      'series': [{'data': 'HTTP_GET1::upload',
                  'label': 'HTTP GET client 1 download out'},
                  {'data': 'HTTP_GET1::download',
                  'label': 'HTTP GET client 1 download in'},
                  {'data': 'HTTP_GET2::upload',
                  'label': 'HTTP GET client 2 download out'},
                  {'data': 'HTTP_GET2::download',
                  'label': 'HTTP GET client 2 download in'},
                  {'data': 'HTTP_POST1::upload',
                  'label': 'HTTP POST client 1 upload out'},
                  {'data': 'HTTP_POST1::download',
                  'label': 'HTTP POST client 1 upload in'},
                  {'data': 'HTTP_POST2::upload',
                  'label': 'HTTP POST client 2 upload out'},
                  {'data': 'HTTP_POST2::download',
                  'label': 'HTTP POST client 2 upload in'},
                ]}

PLOTS['transaction'] = {'description': 'HTTP transaction plot',
      'type': 'timeseries',
      'series': [{'data': 'HTTP_GET1::transaction',
                  'label': 'HTTP GET client 2 transactions'},
                  {'data': 'HTTP_GET2::transaction',
                  'label': 'HTTP GET client 2 transactions'},
                  {'data': 'HTTP_POST1::transaction',
                  'label': 'HTTP POST client 1 transactions'},
                  {'data': 'HTTP_POST2::transaction',
                  'label': 'HTTP POST client 2 transactions'}
                ]}

PLOTS['responsetime'] = {'description': 'HTTP response time plot',
      'type': 'timeseries',
      'series': [{'data': 'HTTP_GET1::responsetime',
                  'label': 'HTTP GET client 1 response time'},
                  {'data': 'HTTP_GET2::responsetime',
                  'label': 'HTTP GET client 2 response time'},
                  {'data': 'HTTP_POST1::responsetime',
                  'label': 'HTTP POST client 1 response time'},
                  {'data': 'HTTP_POST2::responsetime',
                  'label': 'HTTP POST client 2 response time'}
                ]}

PLOTS['bandwidth_total'] = {'description': 'TCP bandwidth total plot',
      'type': 'timeseries',
      'series': [{'data': 'TCP upload sum',
                  'label': 'TCP upload total'},
                  {'data': 'TCP download sum',
                  'label': 'TCP download total'},
                ]}

PLOTS['bandwidth_total_client1'] = {'description': 'TCP bandwidth total plot (client1)',
      'type': 'timeseries',
      'series': [{'data': 'TCP upload sum client1',
                  'label': 'TCP upload total (client1)'},
                  {'data': 'TCP download sum client1',
                  'label': 'TCP download total (client1)'},
                ]}

PLOTS['bandwidth_total_client2'] = {'description': 'TCP bandwidth total plot (client2)',
      'type': 'timeseries',
      'series': [{'data': 'TCP upload sum client2',
                  'label': 'TCP upload total (client2)'},
                  {'data': 'TCP download sum client2',
                  'label': 'TCP download total (client2)'},
                ]}


include("common.inc")